BEGIN
    -- 2025-10-15 2제강 아이디 매칭 데이터 작업
    -- 작성일 : 2025-10-15
    -- 수정일 : 2025-10-15
    -- 작성자 : 하민규
    -- 파라미터 : YYYY-MM-DD 형식의 문자열

    -- DECLARE dateFrom DATE DEFAULT CURRENT_DATE-2 ;
    -- DECLARE dateTo DATE DEFAULT CURRENT_DATE-2 ;

  INSERT INTO sm2_tag.mid_stats_rt (
    heat_no,
    step_seq_no,
    step_cd,
    rework_seq_no,
    zone_id,
    zone_nm,
    subzone_nm,
    entry_dtm,
    exit_dtm,
    cssteelkindname,
    stats_sec_dtm,
	sm2zone01_1,
	sm2zone01_2,
	sm2zone01_3,
	sm2zone01_4,
	sm2zone01_5,
	sm2zone01_6,
	sm2zone01_7,
	sm2zone01_8,
	sm2zone01_9,
	sm2zone01_10,
	sm2zone01_11,
	sm2zone01_12,
	sm2zone01_13,
	sm2zone01_14,
	sm2zone01_15,
	sm2zone01_16,
	sm2zone01_17,
	sm2zone01_18,
	sm2zone01_19,
	sm2zone01_20,
	sm2zone01_21,
	sm2zone01_22,
	sm2zone01_23,
	sm2zone01_24,
	sm2zone01_25,
	sm2zone01_26,
	sm2zone01_27,
	sm2zone01_28,
	sm2zone01_29,
	sm2zone01_30,
	sm2zone01_31,
	sm2zone01_32,
	sm2zone01_33,
	sm2zone01_34,
	sm2zone01_35,
	sm2zone01_36,
	sm2zone01_37,
	sm2zone01_38,
	sm2zone01_39,
	sm2zone01_40,
	sm2zone01_41,
	sm2zone01_42,
	sm2zone01_43,
	sm2zone01_44,
	sm2zone01_45,
	sm2zone01_46,
	sm2zone01_47,
	sm2zone01_48,
	sm2zone01_49,
	sm2zone01_50,
	sm2zone01_51,
	sm2zone01_52,
	sm2zone01_53,
	sm2zone01_54,
	sm2zone01_55,
	sm2zone01_56,
	sm2zone01_57,
	sm2zone01_58,
	sm2zone01_59,
	sm2zone01_60,
	sm2zone01_61,
	sm2zone01_62,
	sm2zone01_63,
	sm2zone01_64,
	sm2zone01_65,
	sm2zone01_66,
	sm2zone01_67,
	sm2zone01_68,
	sm2zone01_69,
	sm2zone01_70,
	sm2zone01_71,
	sm2zone01_72,
	sm2zone01_73,
	sm2zone01_74,
	sm2zone01_75,
	sm2zone01_76,
	sm2zone01_77,
	sm2zone01_78,
	sm2zone01_79,
	sm2zone01_80,
	sm2zone01_81,
	sm2zone01_82,
	sm2zone01_83,
	sm2zone01_84,
	sm2zone01_85,
	sm2zone01_86,
	sm2zone01_87,
	sm2zone01_88,
	sm2zone01_89,
	sm2zone01_90,
	sm2zone01_91,
	sm2zone01_92,
	sm2zone01_93,
	sm2zone01_94,
	sm2zone01_95,
	sm2zone01_96,
	sm2zone01_97,
	sm2zone01_98,
	sm2zone01_99,
	sm2zone01_100,
	sm2zone01_101,
	sm2zone01_102,
	sm2zone01_103,
	sm2zone01_104,
	sm2zone01_105,
	sm2zone01_106,
	sm2zone01_107,
	sm2zone01_108,
	sm2zone01_109,
	sm2zone01_110,
	sm2zone01_111,
	sm2zone01_112,
	sm2zone01_113,
	sm2zone01_114,
	sm2zone01_115,
	sm2zone01_116,
	sm2zone01_117,
	sm2zone01_118,
	sm2zone01_119,
	sm2zone01_120,
	sm2zone01_121,
	sm2zone01_122,
	sm2zone01_123,
	sm2zone01_124,
	sm2zone01_125,
	sm2zone01_126,
	sm2zone01_127,
	sm2zone01_128,
	sm2zone01_129,
	sm2zone01_130,
	sm2zone01_131,
	sm2zone01_132,
	sm2zone01_133,
	sm2zone01_134,
	sm2zone01_135,
	sm2zone01_136,
	sm2zone01_137,
	sm2zone01_138,
	sm2zone01_139,
	sm2zone01_140,
	sm2zone01_141,
	sm2zone01_142,
	sm2zone01_143,
	sm2zone01_144,
	sm2zone01_145,
	sm2zone01_146,
	sm2zone01_147,
	sm2zone01_148,
	sm2zone02_1,
	sm2zone02_2,
	sm2zone02_3,
	sm2zone02_4,
	sm2zone02_5,
	sm2zone02_6,
	sm2zone02_7,
	sm2zone02_8,
	sm2zone02_9,
	sm2zone02_10,
	sm2zone02_11,
	sm2zone02_12,
	sm2zone02_13,
	sm2zone02_14,
	sm2zone02_15,
	sm2zone02_16,
	sm2zone02_17,
	sm2zone02_18,
	sm2zone02_19,
	sm2zone02_20,
	sm2zone02_21,
	sm2zone02_22,
	sm2zone02_23,
	sm2zone02_24,
	sm2zone02_25,
	sm2zone02_26,
	sm2zone02_27,
	sm2zone02_28,
	sm2zone02_29,
	sm2zone02_30,
	sm2zone02_31,
	sm2zone02_32,
	sm2zone02_33,
	sm2zone02_34,
	sm2zone02_35,
	sm2zone02_36,
	sm2zone02_37,
	sm2zone02_38,
	sm2zone02_39,
	sm2zone02_40,
	sm2zone02_41,
	sm2zone02_42,
	sm2zone02_43,
	sm2zone02_44,
	sm2zone02_45,
	sm2zone02_46,
	sm2zone02_47,
	sm2zone02_48,
	sm2zone02_49,
	sm2zone02_50,
	sm2zone02_51,
	sm2zone02_52,
	sm2zone02_53,
	sm2zone02_54,
	sm2zone02_55,
	sm2zone02_56,
	sm2zone02_57,
	sm2zone02_58,
	sm2zone02_59,
	sm2zone02_60,
	sm2zone02_61,
	sm2zone02_62,
	sm2zone02_63,
	sm2zone02_64,
	sm2zone02_65,
	sm2zone02_66,
	sm2zone02_67,
	sm2zone02_68,
	sm2zone02_69,
	sm2zone02_70,
	sm2zone02_71,
	sm2zone02_72,
	sm2zone02_73,
	sm2zone02_74,
	sm2zone02_75,
	sm2zone02_76,
	sm2zone02_77,
	sm2zone02_78,
	sm2zone02_79,
	sm2zone02_80,
	sm2zone02_81,
	sm2zone02_82,
	sm2zone02_83,
	sm2zone02_84,
	sm2zone03_1,
	sm2zone03_2,
	sm2zone03_3,
	sm2zone03_4,
	sm2zone03_5,
	sm2zone03_6,
	sm2zone03_7,
	sm2zone03_8,
	sm2zone03_9,
	sm2zone03_10,
	sm2zone03_11,
	sm2zone03_12,
	sm2zone03_13,
	sm2zone03_14,
	sm2zone03_15,
	sm2zone03_16,
	sm2zone03_17,
	sm2zone03_18,
	sm2zone03_19,
	sm2zone03_20,
	sm2zone03_21,
	sm2zone03_22,
	sm2zone03_23,
	sm2zone03_24,
	sm2zone03_25,
	sm2zone03_26,
	sm2zone03_27,
	sm2zone03_28,
	sm2zone03_29,
	sm2zone03_30,
	sm2zone03_31,
	sm2zone03_32,
	sm2zone03_33,
	sm2zone03_34,
	sm2zone03_35,
	sm2zone03_36,
	sm2zone03_37,
	sm2zone03_38,
	sm2zone03_39,
	sm2zone03_40,
	sm2zone03_41,
	sm2zone03_42,
	sm2zone03_43,
	sm2zone03_44,
	sm2zone03_45,
	sm2zone03_46,
	sm2zone03_47,
	sm2zone03_48,
	sm2zone03_49,
	sm2zone03_50,
	sm2zone03_51,
	sm2zone03_52,
	sm2zone03_53,
	sm2zone03_54,
	sm2zone03_55,
	sm2zone03_56,
	sm2zone03_57,
	sm2zone03_58,
	sm2zone03_59,
	sm2zone03_60,
	sm2zone03_61,
	sm2zone03_62,
	sm2zone03_63,
	sm2zone03_64,
	sm2zone03_65,
	sm2zone03_66,
	sm2zone03_67,
	sm2zone03_68,
	sm2zone03_69,
	sm2zone03_70,
	sm2zone03_71,
	sm2zone03_72,
	sm2zone03_73,
	sm2zone03_74,
	sm2zone03_75,
	sm2zone03_76,
	sm2zone03_77,
	sm2zone03_78,
	sm2zone03_79,
	sm2zone03_80,
	sm2zone03_81,
	sm2zone03_82,
	sm2zone03_83,
	sm2zone03_84,
	sm2zone03_85,
	sm2zone03_86,
	sm2zone03_87,
	sm2zone04_1,
	sm2zone04_2,
	sm2zone04_3,
	sm2zone04_4,
	sm2zone04_5,
	sm2zone04_6,
	sm2zone04_7,
	sm2zone04_8,
	sm2zone04_9,
	sm2zone04_10,
	sm2zone04_11,
	sm2zone04_12,
	sm2zone04_13,
	sm2zone04_14,
	sm2zone04_15,
	sm2zone04_16,
	sm2zone04_17,
	sm2zone04_18,
	sm2zone04_19,
	sm2zone04_20,
	sm2zone04_21,
	sm2zone04_22,
	sm2zone04_23,
	sm2zone04_24,
	sm2zone04_25,
	sm2zone04_26,
	sm2zone04_27,
	sm2zone04_28,
	sm2zone05_1,
	sm2zone05_2,
	sm2zone05_3,
	sm2zone05_4,
	sm2zone05_5,
	sm2zone05_6,
	sm2zone05_7,
	sm2zone05_8,
	sm2zone05_9,
	sm2zone05_10,
	sm2zone05_11,
	sm2zone05_12,
	sm2zone05_13,
	sm2zone05_14,
	sm2zone05_15,
	sm2zone05_16,
	sm2zone05_17,
	sm2zone05_18,
	sm2zone05_19,
	sm2zone05_20,
	sm2zone05_21,
	sm2zone05_22,
	sm2zone05_23,
	sm2zone05_24,
	sm2zone05_25,
	sm2zone05_26,
	sm2zone05_27,
	sm2zone05_28,
	sm2zone05_29,
	sm2zone05_30
      )
  WITH T1 AS (
    SELECT
      t1.heat_no,
      t3.step_seq_no,
      t1.step_cd,
      t1.rework_seq_no,
      DATETIME_TRUNC(MIN(t1.entry_dtm), SECOND) entry_dtm,
      DATETIME_TRUNC(MAX(t1.exit_dtm), SECOND) exit_dtm,
      t2.zone_id,
      t1.zone_nm,
      t1.subzone_nm
    FROM `sm2_l2.sm2_zone_mid_trk_mt` t1
    LEFT JOIN `sm2_l2.sm2_zone_info_mt` t2 ON t1.subzone_nm=t2.zone_nm
    LEFT JOIN `sm2_l2.sm2_step_info_mt` t3 ON t1.subzone_nm=t3.zone_nm AND t1.step_cd=t3.step_cd
    WHERE (1=1)
    AND t1.abnorm_yn IN ('n', 'N')
    AND t1.entry_dtm IS NOT NULL
    AND t1.exit_dtm IS NOT NULL
    AND t1.entry_dtm < t1.exit_dtm
    AND DATE(t1.inout_dtm) BETWEEN DATE_SUB(dateFrom, INTERVAL 1 DAY) AND DATE_ADD(dateTo, INTERVAL 1 DAY)
    AND DATE(t1.entry_dtm) BETWEEN dateFrom AND dateTo
    GROUP BY t1.heat_no, t3.step_seq_no, t1.step_cd, t1.rework_seq_no, t2.zone_id, t1.zone_nm, t1.subzone_nm, t2.zone_cd
  ), T2 AS (
    SELECT *
    FROM (
      SELECT
        heat_no, cssteelkindname,
        ROW_NUMBER() OVER(PARTITION BY heat_no ORDER BY trktime DESC) AS row_num
      FROM dataforge-seahcss.sm2_l2.sm2_workorder_mt
      WHERE 
        DATE(trktime) BETWEEN DATE_SUB(dateFrom, INTERVAL 1 YEAR) AND DATE_ADD(dateTo, INTERVAL 1 YEAR) AND 
        cssteelkindname in ('316LDS1', 'STS410S5','STS304SX','STS303S1','316LDSZ')
    )
    WHERE row_num = 1
  ), T3 AS (
    SELECT DATETIME(stats_sec_dtm) AS stats_sec_dtm
    FROM UNNEST(GENERATE_TIMESTAMP_ARRAY(TIMESTAMP(CONCAT(dateFrom, ' 00:00:00')), TIMESTAMP(CONCAT(dateTo, ' 23:59:59')), INTERVAL 1 SECOND)) AS stats_sec_dtm  
  ), Z1 AS ( SELECT 'EAF' zone_nm, * FROM sm2_tag.tag_sec_zone01_st  WHERE DATE(stats_sec_dtm) BETWEEN dateFrom AND DATE_ADD(dateTo, INTERVAL 1 DAY)
  ), Z2 AS ( SELECT 'LF'  zone_nm, * FROM sm2_tag.tag_sec_zone02_st  WHERE DATE(stats_sec_dtm) BETWEEN dateFrom AND DATE_ADD(dateTo, INTERVAL 1 DAY)
  ), Z3 AS ( SELECT 'VD'  zone_nm, * FROM sm2_tag.tag_sec_zone03_st  WHERE DATE(stats_sec_dtm) BETWEEN dateFrom AND DATE_ADD(dateTo, INTERVAL 1 DAY)
  ), Z4 AS ( SELECT 'AOD' zone_nm, * FROM sm2_tag.tag_sec_zone04_st  WHERE DATE(stats_sec_dtm) BETWEEN dateFrom AND DATE_ADD(dateTo, INTERVAL 1 DAY)
  ), Z5 AS ( SELECT 'LTS' zone_nm, * FROM sm2_tag.tag_sec_zone05_st  WHERE DATE(stats_sec_dtm) BETWEEN dateFrom AND DATE_ADD(dateTo, INTERVAL 1 DAY)
  ), T9 AS (
    SELECT
      T1.heat_no,
      CAST(T1.step_seq_no AS STRING) step_seq_no,
      T1.step_cd,
      CAST(T1.rework_seq_no AS STRING) rework_seq_no,
      CAST(T1.zone_id AS STRING) zone_id,
      T1.zone_nm,
      T1.subzone_nm,
      T1.entry_dtm,
      T1.exit_dtm,
      T2.cssteelkindname,
      T3.stats_sec_dtm,
      Z1.* EXCEPT(zone_nm, stats_sec_dtm),
      Z2.* EXCEPT(zone_nm, stats_sec_dtm),
      Z3.* EXCEPT(zone_nm, stats_sec_dtm),
      Z4.* EXCEPT(zone_nm, stats_sec_dtm),
      Z5.* EXCEPT(zone_nm, stats_sec_dtm)
    FROM T1
    LEFT JOIN T2 t2 ON t1.heat_no=t2.heat_no
    LEFT JOIN T3 ON T3.stats_sec_dtm BETWEEN T1.entry_dtm AND T1.exit_dtm
    LEFT JOIN Z1 ON T1.zone_nm=Z1.zone_nm AND T3.stats_sec_dtm=Z1.stats_sec_dtm
    LEFT JOIN Z2 ON T1.zone_nm=Z2.zone_nm AND T3.stats_sec_dtm=Z2.stats_sec_dtm
    LEFT JOIN Z3 ON T1.zone_nm=Z3.zone_nm AND T3.stats_sec_dtm=Z3.stats_sec_dtm
    LEFT JOIN Z4 ON T1.zone_nm=Z4.zone_nm AND T3.stats_sec_dtm=Z4.stats_sec_dtm
    LEFT JOIN Z5 ON T1.zone_nm=Z5.zone_nm AND T3.stats_sec_dtm=Z5.stats_sec_dtm
    WHERE NOT (
          Z1.stats_sec_dtm IS NULL
      AND Z2.stats_sec_dtm IS NULL
      AND Z3.stats_sec_dtm IS NULL
      AND Z4.stats_sec_dtm IS NULL
      AND Z5.stats_sec_dtm IS NULL
    )
  )
  SELECT
    heat_no,
    step_seq_no,
    step_cd,
    rework_seq_no,
    zone_id,
    zone_nm,
    subzone_nm,
    entry_dtm,
    exit_dtm,
    cssteelkindname,
    ARRAY_AGG(stats_sec_dtm IGNORE NULLS ORDER BY stats_sec_dtm) stats_sec_dtm,
	ARRAY_AGG(sm2zone01_1 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_1, 
	ARRAY_AGG(sm2zone01_2 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_2, 
	ARRAY_AGG(sm2zone01_3 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_3, 
	ARRAY_AGG(sm2zone01_4 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_4, 
	ARRAY_AGG(sm2zone01_5 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_5, 
	ARRAY_AGG(sm2zone01_6 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_6, 
	ARRAY_AGG(sm2zone01_7 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_7, 
	ARRAY_AGG(sm2zone01_8 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_8, 
	ARRAY_AGG(sm2zone01_9 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_9, 
	ARRAY_AGG(sm2zone01_10 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_10, 
	ARRAY_AGG(sm2zone01_11 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_11, 
	ARRAY_AGG(sm2zone01_12 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_12, 
	ARRAY_AGG(sm2zone01_13 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_13, 
	ARRAY_AGG(sm2zone01_14 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_14, 
	ARRAY_AGG(sm2zone01_15 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_15, 
	ARRAY_AGG(sm2zone01_16 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_16, 
	ARRAY_AGG(sm2zone01_17 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_17, 
	ARRAY_AGG(sm2zone01_18 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_18, 
	ARRAY_AGG(sm2zone01_19 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_19, 
	ARRAY_AGG(sm2zone01_20 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_20, 
	ARRAY_AGG(sm2zone01_21 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_21, 
	ARRAY_AGG(sm2zone01_22 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_22, 
	ARRAY_AGG(sm2zone01_23 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_23, 
	ARRAY_AGG(sm2zone01_24 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_24, 
	ARRAY_AGG(sm2zone01_25 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_25, 
	ARRAY_AGG(sm2zone01_26 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_26, 
	ARRAY_AGG(sm2zone01_27 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_27, 
	ARRAY_AGG(sm2zone01_28 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_28, 
	ARRAY_AGG(sm2zone01_29 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_29, 
	ARRAY_AGG(sm2zone01_30 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_30, 
	ARRAY_AGG(sm2zone01_31 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_31, 
	ARRAY_AGG(sm2zone01_32 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_32, 
	ARRAY_AGG(sm2zone01_33 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_33, 
	ARRAY_AGG(sm2zone01_34 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_34, 
	ARRAY_AGG(sm2zone01_35 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_35, 
	ARRAY_AGG(sm2zone01_36 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_36, 
	ARRAY_AGG(sm2zone01_37 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_37, 
	ARRAY_AGG(sm2zone01_38 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_38, 
	ARRAY_AGG(sm2zone01_39 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_39, 
	ARRAY_AGG(sm2zone01_40 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_40, 
	ARRAY_AGG(sm2zone01_41 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_41, 
	ARRAY_AGG(sm2zone01_42 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_42, 
	ARRAY_AGG(sm2zone01_43 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_43, 
	ARRAY_AGG(sm2zone01_44 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_44, 
	ARRAY_AGG(sm2zone01_45 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_45, 
	ARRAY_AGG(sm2zone01_46 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_46, 
	ARRAY_AGG(sm2zone01_47 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_47, 
	ARRAY_AGG(sm2zone01_48 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_48, 
	ARRAY_AGG(sm2zone01_49 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_49, 
	ARRAY_AGG(sm2zone01_50 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_50, 
	ARRAY_AGG(sm2zone01_51 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_51, 
	ARRAY_AGG(sm2zone01_52 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_52, 
	ARRAY_AGG(sm2zone01_53 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_53, 
	ARRAY_AGG(sm2zone01_54 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_54, 
	ARRAY_AGG(sm2zone01_55 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_55, 
	ARRAY_AGG(sm2zone01_56 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_56, 
	ARRAY_AGG(sm2zone01_57 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_57, 
	ARRAY_AGG(sm2zone01_58 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_58, 
	ARRAY_AGG(sm2zone01_59 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_59, 
	ARRAY_AGG(sm2zone01_60 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_60, 
	ARRAY_AGG(sm2zone01_61 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_61, 
	ARRAY_AGG(sm2zone01_62 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_62, 
	ARRAY_AGG(sm2zone01_63 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_63, 
	ARRAY_AGG(sm2zone01_64 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_64, 
	ARRAY_AGG(sm2zone01_65 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_65, 
	ARRAY_AGG(sm2zone01_66 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_66, 
	ARRAY_AGG(sm2zone01_67 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_67, 
	ARRAY_AGG(sm2zone01_68 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_68, 
	ARRAY_AGG(sm2zone01_69 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_69, 
	ARRAY_AGG(sm2zone01_70 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_70, 
	ARRAY_AGG(sm2zone01_71 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_71, 
	ARRAY_AGG(sm2zone01_72 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_72, 
	ARRAY_AGG(sm2zone01_73 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_73, 
	ARRAY_AGG(sm2zone01_74 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_74, 
	ARRAY_AGG(sm2zone01_75 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_75, 
	ARRAY_AGG(sm2zone01_76 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_76, 
	ARRAY_AGG(sm2zone01_77 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_77, 
	ARRAY_AGG(sm2zone01_78 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_78, 
	ARRAY_AGG(sm2zone01_79 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_79, 
	ARRAY_AGG(sm2zone01_80 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_80, 
	ARRAY_AGG(sm2zone01_81 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_81, 
	ARRAY_AGG(sm2zone01_82 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_82, 
	ARRAY_AGG(sm2zone01_83 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_83, 
	ARRAY_AGG(sm2zone01_84 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_84, 
	ARRAY_AGG(sm2zone01_85 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_85, 
	ARRAY_AGG(sm2zone01_86 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_86, 
	ARRAY_AGG(sm2zone01_87 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_87, 
	ARRAY_AGG(sm2zone01_88 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_88, 
	ARRAY_AGG(sm2zone01_89 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_89, 
	ARRAY_AGG(sm2zone01_90 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_90, 
	ARRAY_AGG(sm2zone01_91 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_91, 
	ARRAY_AGG(sm2zone01_92 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_92, 
	ARRAY_AGG(sm2zone01_93 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_93, 
	ARRAY_AGG(sm2zone01_94 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_94, 
	ARRAY_AGG(sm2zone01_95 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_95, 
	ARRAY_AGG(sm2zone01_96 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_96, 
	ARRAY_AGG(sm2zone01_97 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_97, 
	ARRAY_AGG(sm2zone01_98 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_98, 
	ARRAY_AGG(sm2zone01_99 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_99, 
	ARRAY_AGG(sm2zone01_100 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_100, 
	ARRAY_AGG(sm2zone01_101 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_101, 
	ARRAY_AGG(sm2zone01_102 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_102, 
	ARRAY_AGG(sm2zone01_103 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_103, 
	ARRAY_AGG(sm2zone01_104 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_104, 
	ARRAY_AGG(sm2zone01_105 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_105, 
	ARRAY_AGG(sm2zone01_106 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_106, 
	ARRAY_AGG(sm2zone01_107 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_107, 
	ARRAY_AGG(sm2zone01_108 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_108, 
	ARRAY_AGG(sm2zone01_109 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_109, 
	ARRAY_AGG(sm2zone01_110 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_110, 
	ARRAY_AGG(sm2zone01_111 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_111, 
	ARRAY_AGG(sm2zone01_112 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_112, 
	ARRAY_AGG(sm2zone01_113 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_113, 
	ARRAY_AGG(sm2zone01_114 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_114, 
	ARRAY_AGG(sm2zone01_115 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_115, 
	ARRAY_AGG(sm2zone01_116 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_116, 
	ARRAY_AGG(sm2zone01_117 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_117, 
	ARRAY_AGG(sm2zone01_118 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_118, 
	ARRAY_AGG(sm2zone01_119 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_119, 
	ARRAY_AGG(sm2zone01_120 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_120, 
	ARRAY_AGG(sm2zone01_121 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_121, 
	ARRAY_AGG(sm2zone01_122 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_122, 
	ARRAY_AGG(sm2zone01_123 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_123, 
	ARRAY_AGG(sm2zone01_124 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_124, 
	ARRAY_AGG(sm2zone01_125 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_125, 
	ARRAY_AGG(sm2zone01_126 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_126, 
	ARRAY_AGG(sm2zone01_127 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_127, 
	ARRAY_AGG(sm2zone01_128 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_128, 
	ARRAY_AGG(sm2zone01_129 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_129, 
	ARRAY_AGG(sm2zone01_130 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_130, 
	ARRAY_AGG(sm2zone01_131 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_131, 
	ARRAY_AGG(sm2zone01_132 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_132, 
	ARRAY_AGG(sm2zone01_133 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_133, 
	ARRAY_AGG(sm2zone01_134 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_134, 
	ARRAY_AGG(sm2zone01_135 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_135, 
	ARRAY_AGG(sm2zone01_136 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_136, 
	ARRAY_AGG(sm2zone01_137 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_137, 
	ARRAY_AGG(sm2zone01_138 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_138, 
	ARRAY_AGG(sm2zone01_139 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_139, 
	ARRAY_AGG(sm2zone01_140 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_140, 
	ARRAY_AGG(sm2zone01_141 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_141, 
	ARRAY_AGG(sm2zone01_142 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_142, 
	ARRAY_AGG(sm2zone01_143 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_143, 
	ARRAY_AGG(sm2zone01_144 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_144, 
	ARRAY_AGG(sm2zone01_145 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_145, 
	ARRAY_AGG(sm2zone01_146 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_146, 
	ARRAY_AGG(sm2zone01_147 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_147, 
	ARRAY_AGG(sm2zone01_148 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone01_148, 
	ARRAY_AGG(sm2zone02_1 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_1, 
	ARRAY_AGG(sm2zone02_2 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_2, 
	ARRAY_AGG(sm2zone02_3 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_3, 
	ARRAY_AGG(sm2zone02_4 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_4, 
	ARRAY_AGG(sm2zone02_5 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_5, 
	ARRAY_AGG(sm2zone02_6 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_6, 
	ARRAY_AGG(sm2zone02_7 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_7, 
	ARRAY_AGG(sm2zone02_8 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_8, 
	ARRAY_AGG(sm2zone02_9 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_9, 
	ARRAY_AGG(sm2zone02_10 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_10, 
	ARRAY_AGG(sm2zone02_11 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_11, 
	ARRAY_AGG(sm2zone02_12 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_12, 
	ARRAY_AGG(sm2zone02_13 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_13, 
	ARRAY_AGG(sm2zone02_14 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_14, 
	ARRAY_AGG(sm2zone02_15 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_15, 
	ARRAY_AGG(sm2zone02_16 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_16, 
	ARRAY_AGG(sm2zone02_17 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_17, 
	ARRAY_AGG(sm2zone02_18 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_18, 
	ARRAY_AGG(sm2zone02_19 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_19, 
	ARRAY_AGG(sm2zone02_20 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_20, 
	ARRAY_AGG(sm2zone02_21 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_21, 
	ARRAY_AGG(sm2zone02_22 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_22, 
	ARRAY_AGG(sm2zone02_23 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_23, 
	ARRAY_AGG(sm2zone02_24 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_24, 
	ARRAY_AGG(sm2zone02_25 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_25, 
	ARRAY_AGG(sm2zone02_26 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_26, 
	ARRAY_AGG(sm2zone02_27 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_27, 
	ARRAY_AGG(sm2zone02_28 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_28, 
	ARRAY_AGG(sm2zone02_29 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_29, 
	ARRAY_AGG(sm2zone02_30 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_30, 
	ARRAY_AGG(sm2zone02_31 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_31, 
	ARRAY_AGG(sm2zone02_32 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_32, 
	ARRAY_AGG(sm2zone02_33 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_33, 
	ARRAY_AGG(sm2zone02_34 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_34, 
	ARRAY_AGG(sm2zone02_35 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_35, 
	ARRAY_AGG(sm2zone02_36 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_36, 
	ARRAY_AGG(sm2zone02_37 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_37, 
	ARRAY_AGG(sm2zone02_38 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_38, 
	ARRAY_AGG(sm2zone02_39 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_39, 
	ARRAY_AGG(sm2zone02_40 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_40, 
	ARRAY_AGG(sm2zone02_41 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_41, 
	ARRAY_AGG(sm2zone02_42 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_42, 
	ARRAY_AGG(sm2zone02_43 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_43, 
	ARRAY_AGG(sm2zone02_44 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_44, 
	ARRAY_AGG(sm2zone02_45 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_45, 
	ARRAY_AGG(sm2zone02_46 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_46, 
	ARRAY_AGG(sm2zone02_47 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_47, 
	ARRAY_AGG(sm2zone02_48 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_48, 
	ARRAY_AGG(sm2zone02_49 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_49, 
	ARRAY_AGG(sm2zone02_50 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_50, 
	ARRAY_AGG(sm2zone02_51 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_51, 
	ARRAY_AGG(sm2zone02_52 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_52, 
	ARRAY_AGG(sm2zone02_53 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_53, 
	ARRAY_AGG(sm2zone02_54 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_54, 
	ARRAY_AGG(sm2zone02_55 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_55, 
	ARRAY_AGG(sm2zone02_56 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_56, 
	ARRAY_AGG(sm2zone02_57 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_57, 
	ARRAY_AGG(sm2zone02_58 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_58, 
	ARRAY_AGG(sm2zone02_59 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_59, 
	ARRAY_AGG(sm2zone02_60 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_60, 
	ARRAY_AGG(sm2zone02_61 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_61, 
	ARRAY_AGG(sm2zone02_62 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_62, 
	ARRAY_AGG(sm2zone02_63 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_63, 
	ARRAY_AGG(sm2zone02_64 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_64, 
	ARRAY_AGG(sm2zone02_65 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_65, 
	ARRAY_AGG(sm2zone02_66 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_66, 
	ARRAY_AGG(sm2zone02_67 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_67, 
	ARRAY_AGG(sm2zone02_68 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_68, 
	ARRAY_AGG(sm2zone02_69 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_69, 
	ARRAY_AGG(sm2zone02_70 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_70, 
	ARRAY_AGG(sm2zone02_71 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_71, 
	ARRAY_AGG(sm2zone02_72 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_72, 
	ARRAY_AGG(sm2zone02_73 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_73, 
	ARRAY_AGG(sm2zone02_74 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_74, 
	ARRAY_AGG(sm2zone02_75 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_75, 
	ARRAY_AGG(sm2zone02_76 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_76, 
	ARRAY_AGG(sm2zone02_77 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_77, 
	ARRAY_AGG(sm2zone02_78 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_78, 
	ARRAY_AGG(sm2zone02_79 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_79, 
	ARRAY_AGG(sm2zone02_80 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_80, 
	ARRAY_AGG(sm2zone02_81 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_81, 
	ARRAY_AGG(sm2zone02_82 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_82, 
	ARRAY_AGG(sm2zone02_83 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_83, 
	ARRAY_AGG(sm2zone02_84 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone02_84, 
	ARRAY_AGG(sm2zone03_1 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_1, 
	ARRAY_AGG(sm2zone03_2 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_2, 
	ARRAY_AGG(sm2zone03_3 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_3, 
	ARRAY_AGG(sm2zone03_4 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_4, 
	ARRAY_AGG(sm2zone03_5 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_5, 
	ARRAY_AGG(sm2zone03_6 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_6, 
	ARRAY_AGG(sm2zone03_7 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_7, 
	ARRAY_AGG(sm2zone03_8 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_8, 
	ARRAY_AGG(sm2zone03_9 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_9, 
	ARRAY_AGG(sm2zone03_10 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_10, 
	ARRAY_AGG(sm2zone03_11 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_11, 
	ARRAY_AGG(sm2zone03_12 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_12, 
	ARRAY_AGG(sm2zone03_13 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_13, 
	ARRAY_AGG(sm2zone03_14 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_14, 
	ARRAY_AGG(sm2zone03_15 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_15, 
	ARRAY_AGG(sm2zone03_16 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_16, 
	ARRAY_AGG(sm2zone03_17 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_17, 
	ARRAY_AGG(sm2zone03_18 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_18, 
	ARRAY_AGG(sm2zone03_19 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_19, 
	ARRAY_AGG(sm2zone03_20 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_20, 
	ARRAY_AGG(sm2zone03_21 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_21, 
	ARRAY_AGG(sm2zone03_22 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_22, 
	ARRAY_AGG(sm2zone03_23 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_23, 
	ARRAY_AGG(sm2zone03_24 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_24, 
	ARRAY_AGG(sm2zone03_25 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_25, 
	ARRAY_AGG(sm2zone03_26 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_26, 
	ARRAY_AGG(sm2zone03_27 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_27, 
	ARRAY_AGG(sm2zone03_28 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_28, 
	ARRAY_AGG(sm2zone03_29 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_29, 
	ARRAY_AGG(sm2zone03_30 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_30, 
	ARRAY_AGG(sm2zone03_31 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_31, 
	ARRAY_AGG(sm2zone03_32 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_32, 
	ARRAY_AGG(sm2zone03_33 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_33, 
	ARRAY_AGG(sm2zone03_34 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_34, 
	ARRAY_AGG(sm2zone03_35 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_35, 
	ARRAY_AGG(sm2zone03_36 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_36, 
	ARRAY_AGG(sm2zone03_37 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_37, 
	ARRAY_AGG(sm2zone03_38 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_38, 
	ARRAY_AGG(sm2zone03_39 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_39, 
	ARRAY_AGG(sm2zone03_40 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_40, 
	ARRAY_AGG(sm2zone03_41 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_41, 
	ARRAY_AGG(sm2zone03_42 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_42, 
	ARRAY_AGG(sm2zone03_43 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_43, 
	ARRAY_AGG(sm2zone03_44 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_44, 
	ARRAY_AGG(sm2zone03_45 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_45, 
	ARRAY_AGG(sm2zone03_46 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_46, 
	ARRAY_AGG(sm2zone03_47 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_47, 
	ARRAY_AGG(sm2zone03_48 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_48, 
	ARRAY_AGG(sm2zone03_49 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_49, 
	ARRAY_AGG(sm2zone03_50 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_50, 
	ARRAY_AGG(sm2zone03_51 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_51, 
	ARRAY_AGG(sm2zone03_52 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_52, 
	ARRAY_AGG(sm2zone03_53 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_53, 
	ARRAY_AGG(sm2zone03_54 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_54, 
	ARRAY_AGG(sm2zone03_55 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_55, 
	ARRAY_AGG(sm2zone03_56 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_56, 
	ARRAY_AGG(sm2zone03_57 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_57, 
	ARRAY_AGG(sm2zone03_58 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_58, 
	ARRAY_AGG(sm2zone03_59 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_59, 
	ARRAY_AGG(sm2zone03_60 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_60, 
	ARRAY_AGG(sm2zone03_61 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_61, 
	ARRAY_AGG(sm2zone03_62 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_62, 
	ARRAY_AGG(sm2zone03_63 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_63, 
	ARRAY_AGG(sm2zone03_64 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_64, 
	ARRAY_AGG(sm2zone03_65 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_65, 
	ARRAY_AGG(sm2zone03_66 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_66, 
	ARRAY_AGG(sm2zone03_67 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_67, 
	ARRAY_AGG(sm2zone03_68 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_68, 
	ARRAY_AGG(sm2zone03_69 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_69, 
	ARRAY_AGG(sm2zone03_70 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_70, 
	ARRAY_AGG(sm2zone03_71 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_71, 
	ARRAY_AGG(sm2zone03_72 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_72, 
	ARRAY_AGG(sm2zone03_73 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_73, 
	ARRAY_AGG(sm2zone03_74 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_74, 
	ARRAY_AGG(sm2zone03_75 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_75, 
	ARRAY_AGG(sm2zone03_76 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_76, 
	ARRAY_AGG(sm2zone03_77 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_77, 
	ARRAY_AGG(sm2zone03_78 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_78, 
	ARRAY_AGG(sm2zone03_79 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_79, 
	ARRAY_AGG(sm2zone03_80 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_80, 
	ARRAY_AGG(sm2zone03_81 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_81, 
	ARRAY_AGG(sm2zone03_82 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_82, 
	ARRAY_AGG(sm2zone03_83 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_83, 
	ARRAY_AGG(sm2zone03_84 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_84, 
	ARRAY_AGG(sm2zone03_85 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_85, 
	ARRAY_AGG(sm2zone03_86 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_86, 
	ARRAY_AGG(sm2zone03_87 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone03_87, 
	ARRAY_AGG(sm2zone04_1 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_1, 
	ARRAY_AGG(sm2zone04_2 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_2, 
	ARRAY_AGG(sm2zone04_3 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_3, 
	ARRAY_AGG(sm2zone04_4 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_4, 
	ARRAY_AGG(sm2zone04_5 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_5, 
	ARRAY_AGG(sm2zone04_6 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_6, 
	ARRAY_AGG(sm2zone04_7 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_7, 
	ARRAY_AGG(sm2zone04_8 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_8, 
	ARRAY_AGG(sm2zone04_9 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_9, 
	ARRAY_AGG(sm2zone04_10 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_10, 
	ARRAY_AGG(sm2zone04_11 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_11, 
	ARRAY_AGG(sm2zone04_12 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_12, 
	ARRAY_AGG(sm2zone04_13 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_13, 
	ARRAY_AGG(sm2zone04_14 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_14, 
	ARRAY_AGG(sm2zone04_15 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_15, 
	ARRAY_AGG(sm2zone04_16 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_16, 
	ARRAY_AGG(sm2zone04_17 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_17, 
	ARRAY_AGG(sm2zone04_18 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_18, 
	ARRAY_AGG(sm2zone04_19 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_19, 
	ARRAY_AGG(sm2zone04_20 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_20, 
	ARRAY_AGG(sm2zone04_21 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_21, 
	ARRAY_AGG(sm2zone04_22 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_22, 
	ARRAY_AGG(sm2zone04_23 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_23, 
	ARRAY_AGG(sm2zone04_24 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_24, 
	ARRAY_AGG(sm2zone04_25 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_25, 
	ARRAY_AGG(sm2zone04_26 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_26, 
	ARRAY_AGG(sm2zone04_27 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_27, 
	ARRAY_AGG(sm2zone04_28 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone04_28, 
	ARRAY_AGG(sm2zone05_1 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_1, 
	ARRAY_AGG(sm2zone05_2 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_2, 
	ARRAY_AGG(sm2zone05_3 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_3, 
	ARRAY_AGG(sm2zone05_4 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_4, 
	ARRAY_AGG(sm2zone05_5 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_5, 
	ARRAY_AGG(sm2zone05_6 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_6, 
	ARRAY_AGG(sm2zone05_7 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_7, 
	ARRAY_AGG(sm2zone05_8 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_8, 
	ARRAY_AGG(sm2zone05_9 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_9, 
	ARRAY_AGG(sm2zone05_10 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_10, 
	ARRAY_AGG(sm2zone05_11 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_11, 
	ARRAY_AGG(sm2zone05_12 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_12, 
	ARRAY_AGG(sm2zone05_13 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_13, 
	ARRAY_AGG(sm2zone05_14 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_14, 
	ARRAY_AGG(sm2zone05_15 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_15, 
	ARRAY_AGG(sm2zone05_16 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_16, 
	ARRAY_AGG(sm2zone05_17 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_17, 
	ARRAY_AGG(sm2zone05_18 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_18, 
	ARRAY_AGG(sm2zone05_19 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_19, 
	ARRAY_AGG(sm2zone05_20 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_20, 
	ARRAY_AGG(sm2zone05_21 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_21, 
	ARRAY_AGG(sm2zone05_22 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_22, 
	ARRAY_AGG(sm2zone05_23 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_23, 
	ARRAY_AGG(sm2zone05_24 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_24, 
	ARRAY_AGG(sm2zone05_25 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_25, 
	ARRAY_AGG(sm2zone05_26 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_26, 
	ARRAY_AGG(sm2zone05_27 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_27, 
	ARRAY_AGG(sm2zone05_28 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_28, 
	ARRAY_AGG(sm2zone05_29 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_29, 
	ARRAY_AGG(sm2zone05_30 IGNORE NULLS ORDER BY stats_sec_dtm) sm2zone05_30
  FROM T9
  GROUP BY
    heat_no,
    step_seq_no,
    step_cd,
    rework_seq_no,
    zone_id,
    zone_nm,
    subzone_nm,
    entry_dtm,
    exit_dtm,
    cssteelkindname
  ;

END